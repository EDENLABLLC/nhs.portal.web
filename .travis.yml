language: node_js
services:
- docker
cache:
  directories:
  - ~/.nvm
  - node_modules
env:
  global:
  - RELEASE_BRANCH="master"
  - DOCKER_HUB_ACCOUNT="edenlabllc"
  - MAIN_BRANCHES="master develop"
  - secure: mnpOySeseQd1l+bvnFeseR7Zq1Dv2n09CngK4JgU7+h50kY72NSyrBlcFg1ctgR8VvoBsGnmio/u8EBH1108KaR4cT8XghrGN+tp4a6HeS0U5RjtNJb546kAc41xlS5Bysn+0Dy4E3DCFTK75qMdHZp2vtbtpgC8m79yDO4YBt+7atFO+zicXwl9MVY30L397NCBRy1/LtAfCxmyAymzYBLwfmh7UoIlnFm/88TvG9x4b0KBAW6ElMdDN6ir0yPcXuM4o+pTcltjHjop6SFeXxYPYNWRugx7RfQQxDCZ4ljTHzjAxdaclkhd7TTgBtNPO4TsnVivOssuyfYMkJSIaEvLSeWalzTmO1bNn4rdGhRU3eP7RCqNWytzCT6/RuVR2dDyYrHqaXa3cuohiibLQHMo9GUOf62JTZ+v/O8dAQ3mj9BmIXQcf5GBBynLIeKN9rrKq4D9LPROaAEFx+zfy1ksZLTuwxYGvPey77KL96AbdLxAFRg1ruRYUH+MlcgrRQENan67Oxso7fgwApdzklW4bzlC2jgybJcjSyvvJSInTFQnlWF/JtixeJdNN9V0gCM49oQXbWOxV0BmUt8nOJ+4/AJ6+me1G05UIvbpPdpA3Uk1I5p/XUblyVvHTUl5LsIHvasqqLgpRUVLs+GwstktIL7bzw3k8tKe8LwUb6M=
node_js:
- 7.5.0
before_install:
- chmod -R +x bin
script:
- ./bin/version-increment.sh
- ./bin/build.sh
- ./bin/start.sh
- sleep 5
- docker ps
- RUNNING_CONTAINERS=`docker ps | wc -l`; if [ "${RUNNING_CONTAINERS//[[:space:]]/}"
  == "1" ]; then echo "[E] Container is not started\!"; docker logs nhs.portal.web
  --details --since 5h; exit 1; fi;
- sleep 5
after_failure:
- docker logs nhs.portal.web
after_success:
- ./bin/ci/push.sh
