(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var toArray = exports.toArray = function toArray(arrayLike) {
  if (Array.isArray(arrayLike)) {
    return arrayLike;
  }

  if (arrayLike instanceof Node) {
    return [arrayLike];
  }

  return Array.prototype.slice.call(arrayLike);
};

var $ = exports.$ = function $(selector) {
  var context = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : document;
  return toArray(context.querySelectorAll.call(context, selector));
};

var selector = exports.selector = function selector(block, elem, modName, modVal) {
  return block + '__' + elem + (modName ? modVal ? '_' + modName + '_' + modVal : '_' + modName : '');
};

var buildClass = exports.buildClass = function buildClass() {
  return '.' + selector.apply(undefined, arguments);
};

var BEM = exports.BEM = function (_ref) {
  _inherits(BEM, _ref);

  function BEM(name, node) {
    _classCallCheck(this, BEM);

    var _this = _possibleConstructorReturn(this, (BEM.__proto__ || Object.getPrototypeOf(BEM)).call(this));

    _this.node = node;
    _this.name = name;
    return _this;
  }

  _createClass(BEM, [{
    key: 'elem',
    value: function elem(name, modName, modVal) {
      return this.node.querySelector(buildClass(this.name, name, modName, modVal));
    }
  }, {
    key: 'elems',
    value: function elems(name, modName, modVal) {
      return $(buildClass(this.name, name, modName, modVal), this.node);
    }
  }, {
    key: 'setMod',
    value: function setMod(elem, elemName, modName, modValue) {
      var _this2 = this;

      toArray(elem).forEach(function (node) {
        return node.classList.add(selector(_this2.name, elemName, modName, modValue));
      });

      return this;
    }
  }, {
    key: 'delMod',
    value: function delMod(elem, elemName, modName) {
      var _this3 = this;

      toArray(elem).forEach(function (node) {
        return node.classList.remove(selector(_this3.name, elemName, modName));
      });

      return this;
    }
  }]);

  return BEM;
}(null);

},{}],2:[function(require,module,exports){
'use strict';

var _dom = require('./dom');

var _utils = require('./utils');

var _search = require('./search');

var _search2 = _interopRequireDefault(_search);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

(0, _utils.fetchJSON)('data/search.json').then(function (data) {
  (0, _dom.$)('.search').forEach(function (node) {
    return new _search2.default(node, data);
  });
});

},{"./dom":1,"./search":3,"./utils":4}],3:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"]) _i["return"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError("Invalid attempt to destructure non-iterable instance"); } }; }();

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _dom = require('./dom');

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var HOVER_DEBOUNCE_TIMEOUT = 200;

var createItem = function createItem(data) {
  var node = document.createElement('li');

  node.classList.add((0, _dom.selector)('search', 'result-item'));
  node.innerHTML = '\n    <div class="search__result-item-title">\n        ' + data.name + '\n    </div>\n    ' + data.address.settlement + ' <br />\n    ' + data.address.street + ', ' + data.address.building + ' <br />\n    \u0422\u0435\u043B.: ' + data.phones[0].number + ' <br />\n    \u0413\u043E\u0434\u0438\u043D\u0438 \u0440\u043E\u0431\u043E\u0442\u0438: \u041F\u043D-\u041F\u0442, 9:00-19:00\n  ';

  return node;
};

var getTooltipContent = function getTooltipContent(data) {
  return '<div class="search__map-tooltip">\n    <b>' + data.name + '</b> <br />\n    ' + data.address.settlement + ' <br />\n    ' + data.address.street + ', ' + data.address.building + ' <br />\n    \u0422\u0435\u043B.: ' + data.phones[0].number + ' <br />\n    \n    <div class="search__map-tooltip-count">\n        ' + data.doctors + '\n        <small>\u043B\u0456\u043A\u0430\u0440\u0456\u0432</small>\n    </div>\n    <div class="search__map-tooltip-count">\n        ' + data.declarations + '\n        <small>\u0434\u0435\u043A\u043B\u0430\u0440\u0430\u0446\u0456\u0439 \u043F\u0456\u0434\u043F\u0438\u0441\u0430\u043D\u043E</small>\n    </div>\n  </div>';
};

var Search = function (_BEM) {
  _inherits(Search, _BEM);

  function Search(node, data) {
    _classCallCheck(this, Search);

    var _this = _possibleConstructorReturn(this, (Search.__proto__ || Object.getPrototypeOf(Search)).call(this, 'search', node));

    _this.markers = [];
    _this.$markerNodes = [];
    _this.timeout = null;


    _this.$result = _this.elem('result');

    _this.data = data;
    _this.map = new google.maps.Map(_this.elem('map'), {
      center: { lat: 50.4021368, lng: 30.4525107 },
      zoom: 11
    });

    _this.tooltip = new google.maps.InfoWindow({
      maxWidth: 250,
      pixelOffset: new google.maps.Size(136, 388),
      zIndex: -2
    });

    var fragment = document.createDocumentFragment();

    _this.data.forEach(function (item, index) {
      var node = createItem(item);

      node.dataset.index = index;
      fragment.appendChild(node);

      var marker = _this.createMarker(item.address.coordinates);
      _this.markers.push(marker);
      _this.$markerNodes.push(node);

      marker.addListener('click', function () {
        return _this.setActive(index);
      });
      marker.addListener('mouseover', function (_ref) {
        var ta = _ref.ta;

        _this.onHoverMarker(index, 'over', ta.target);
      });
      marker.addListener('mouseout', function () {
        return _this.onHoverMarker(index, 'out');
      });
    });

    _this.$result.appendChild(fragment);

    _this.$result.addEventListener('click', function (_ref2) {
      var target = _ref2.target;

      var $item = target.closest((0, _dom.buildClass)(_this.name, 'result-item'));

      if ($item === null) {
        return;
      }

      _this.map.setCenter({
        lat: _this.data[$item.dataset.index].address.coordinates[0],
        lng: _this.data[$item.dataset.index].address.coordinates[1]
      });

      _this.map.setZoom(11);

      _this.setActive($item.dataset.index);
    }, false);

    _this.activeMarker = new google.maps.Marker({
      map: _this.map,
      zIndex: 2,
      icon: {
        url: 'images/icons/marker.png',
        scaledSize: new google.maps.Size(33, 47),
        anchor: new google.maps.Point(17, 60)
      }
    });
    return _this;
  }

  _createClass(Search, [{
    key: 'onHoverMarker',
    value: function onHoverMarker(index, type) {
      var _this2 = this;

      clearTimeout(this.timeout);
      this.timeout = setTimeout(function () {
        switch (type) {
          case 'over':
            _this2.showTooltip(index);
            break;
          case 'out':
            _this2.hideTooltip();
            break;
        }
      }, HOVER_DEBOUNCE_TIMEOUT);
    }
  }, {
    key: 'hideTooltip',
    value: function hideTooltip() {
      var _this3 = this;

      var node = this.$tooltipNode;

      if (!node) {
        return;
      }

      var player = node.animate([{ opacity: 1, transform: 'translateY(0)' }, { opacity: 0, transform: 'translateY(-20px)' }], this.constructor.ANIMATION_OPTIONS);

      var marker = this.hoverMarker;
      var size = 20;
      requestAnimationFrame(function animate() {
        if (size <= 0) {
          marker.setMap(null);
          return;
        }

        marker.setIcon(_extends({}, marker.getIcon(), { scale: size }));
        size = size - 2;
        requestAnimationFrame(animate);
      });

      player.onfinish = function () {
        _this3.tooltip.close();
      };

      this.activeIndex = -1;
    }
  }, {
    key: 'showTooltip',
    value: function showTooltip(index) {
      var _this4 = this;

      if (index === this.activeIndex) {
        return;
      }

      this.tooltip.setContent(getTooltipContent(this.data[index]));
      this.tooltip.open(this.map, this.markers[index]);

      var node = this.$tooltipNode = this.tooltipNode.parentNode;
      node.removeChild(node.firstChild);
      node.removeChild(node.lastChild);

      node.addEventListener('mouseover', function () {
        clearTimeout(_this4.timeout);
      }, false);

      node.addEventListener('mouseout', function () {
        _this4.onHoverMarker(index, 'out');
      }, false);

      if (this.hoverMarker) {
        this.hoverMarker.setMap(null);
      }

      var marker = this.hoverMarker = new google.maps.Marker({
        position: {
          lat: this.data[index].address.coordinates[0],
          lng: this.data[index].address.coordinates[1]
        },
        zIndex: -2,
        icon: {
          path: google.maps.SymbolPath.CIRCLE,
          scale: 0,
          strokeColor: '#4880ed',
          fillOpacity: 1,
          fillColor: '#4880ed'
        },
        opacity: .1,
        draggable: true,
        map: this.map
      });

      this.activeIndex = index;

      marker.addListener('mouseover', function () {
        _this4.onHoverMarker(index, 'over');
      });

      marker.addListener('mouseout', function () {
        _this4.onHoverMarker(index, 'out');
      });

      var size = 0;
      requestAnimationFrame(function animate() {
        if (size >= 20) {
          return;
        }

        marker.setIcon(_extends({}, marker.getIcon(), { scale: size }));
        size = size + 2;
        requestAnimationFrame(animate);
      });

      if (index === this.activeMarkerIndex) {
        this.tooltipNode.animate([{ opacity: 0, transform: 'translateY(0px)' }, { opacity: 1, transform: 'translateY(10px)' }], this.constructor.ANIMATION_OPTIONS);
      } else {
        this.tooltipNode.animate([{ opacity: 0, transform: 'translateY(-20px)' }, { opacity: 1, transform: 'translateY(0)' }], this.constructor.ANIMATION_OPTIONS);
      }
    }
  }, {
    key: 'setActive',
    value: function setActive(index) {
      if (index === this.activeMarkerIndex) {
        return;
      }

      var address = this.data[index].address;

      var $item = this.$markerNodes[index];

      if (index === this.activeIndex) {
        this.tooltipNode.style.top = '18px';
      }

      if (this.$active) {
        this.delMod(this.$active, 'result-item', 'active');
        this.markers[this.$active.dataset.index].setIcon(this.defaultMarkerIcon);
      }

      this.setMod($item, 'result-item', 'active');
      this.$active = $item;
      this.activeMarkerIndex = Number(index);

      this.markers[$item.dataset.index].setIcon(this.activeMarkerIcon);

      this.activeMarker.setPosition({ lat: address.coordinates[0], lng: address.coordinates[1] });
    }
  }, {
    key: 'createMarker',
    value: function createMarker(_ref3) {
      var _ref4 = _slicedToArray(_ref3, 2),
          lat = _ref4[0],
          lng = _ref4[1];

      return new google.maps.Marker({
        position: { lat: lat, lng: lng },
        zIndex: -1,
        icon: this.defaultMarkerIcon,
        draggable: false,
        map: this.map
      });
    }
  }, {
    key: 'defaultMarkerIcon',
    get: function get() {
      return {
        path: google.maps.SymbolPath.CIRCLE,
        scale: 4,
        strokeColor: '#4880ed',
        fillOpacity: 1,
        fillColor: '#4880ed'
      };
    }
  }, {
    key: 'activeMarkerIcon',
    get: function get() {
      return {
        path: google.maps.SymbolPath.CIRCLE,
        scale: 8,
        strokeColor: '#4880ed',
        fillOpacity: 1,
        fillColor: '#ffffff',
        strokeWeight: 6
      };
    }
  }, {
    key: 'tooltipNode',
    get: function get() {
      return document.querySelector('.gm-style-iw');
    }
  }]);

  return Search;
}(_dom.BEM);

Search.ANIMATION_OPTIONS = {
  duration: 200,
  fill: 'forwards',
  easing: 'ease-in-out'
};
exports.default = Search;
module.exports = exports['default'];

},{"./dom":1}],4:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
var objectToQuery = function objectToQuery(target) {
  return '?' + Object.keys(target).reduce(function (arr, key) {
    return arr.push(key + '=' + target[key]) && arr;
  }, []).join('&');
};

var numberFormatting = exports.numberFormatting = function numberFormatting(number) {
  return number.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1 ').split('.')[0];
};

var fetchJSON = exports.fetchJSON = function fetchJSON(url) {
  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : { method: 'GET' };
  return new Promise(function (resolve, reject) {
    var request = new XMLHttpRequest();

    if (options.body && options.method === 'GET') {
      url += objectToQuery(options.body);
    }

    request.onreadystatechange = function () {
      if (request.readyState !== 4) {
        return;
      }

      resolve(JSON.parse(request.responseText));
    };

    request.onerror = reject;
    request.open(options.method || 'GET', url);
    request.send(options.body ? JSON.stringify(options.body) : null);
  });
};

},{}]},{},[2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvc2NyaXB0cy9kb20uanMiLCJzcmMvc2NyaXB0cy9tYWluLW1hcC5qcyIsInNyYy9zY3JpcHRzL3NlYXJjaC5qcyIsInNyYy9zY3JpcHRzL3V0aWxzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7Ozs7QUNBTyxJQUFNLDRCQUFVLFNBQVYsT0FBVSxZQUFhO0FBQ2xDLE1BQUksTUFBTSxPQUFOLENBQWMsU0FBZCxDQUFKLEVBQThCO0FBQzVCLFdBQU8sU0FBUDtBQUNEOztBQUVELE1BQUkscUJBQXFCLElBQXpCLEVBQStCO0FBQzdCLFdBQU8sQ0FBQyxTQUFELENBQVA7QUFDRDs7QUFFRCxTQUFPLE1BQU0sU0FBTixDQUFnQixLQUFoQixDQUFzQixJQUF0QixDQUEyQixTQUEzQixDQUFQO0FBQ0QsQ0FWTTs7QUFZQSxJQUFNLGdCQUFJLFNBQUosQ0FBSSxDQUFDLFFBQUQ7QUFBQSxNQUFXLE9BQVgsdUVBQXFCLFFBQXJCO0FBQUEsU0FDZixRQUFRLFFBQVEsZ0JBQVIsQ0FBeUIsSUFBekIsQ0FBOEIsT0FBOUIsRUFBdUMsUUFBdkMsQ0FBUixDQURlO0FBQUEsQ0FBVjs7QUFJQSxJQUFNLDhCQUFXLFNBQVgsUUFBVyxDQUFDLEtBQUQsRUFBUSxJQUFSLEVBQWMsT0FBZCxFQUF1QixNQUF2QjtBQUFBLFNBQ25CLEtBRG1CLFVBQ1QsSUFEUyxJQUNGLFVBQVcsZUFBYSxPQUFiLFNBQXdCLE1BQXhCLFNBQXVDLE9BQWxELEdBQStELEVBRDdEO0FBQUEsQ0FBakI7O0FBSUEsSUFBTSxrQ0FBYSxTQUFiLFVBQWE7QUFBQSxlQUFpQixvQ0FBakI7QUFBQSxDQUFuQjs7SUFFTSxHLFdBQUEsRzs7O0FBQ1gsZUFBWSxJQUFaLEVBQWtCLElBQWxCLEVBQXdCO0FBQUE7O0FBQUE7O0FBRXRCLFVBQUssSUFBTCxHQUFZLElBQVo7QUFDQSxVQUFLLElBQUwsR0FB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TTtBQUNqQyxVQUFJLFFBQVEsVUFBUixLQUF1QixDQUEzQixFQUE4QjtBQUM1QjtBQUNEOztBQUVELGNBQVEsS0FBSyxLQUFMLENBQVcsUUFBUSxZQUFuQixDQUFSO0FBQ0QsS0FORDs7QUFRQSxZQUFRLE9BQVIsR0FBa0IsTUFBbEI7QUFDQSxZQUFRLElBQVIsQ0FBYSxRQUFRLE1BQVIsSUFBa0IsS0FBL0IsRUFBc0MsR0FBdEM7QUFDQSxZQUFRLElBQVIsQ0FBYSxRQUFRLElBQVIsR0FBZSxLQUFLLFNBQUwsQ0FBZSxRQUFRLElBQXZCLENBQWYsR0FBOEMsSUFBM0Q7QUFDRCxHQWxCOEQsQ0FBdEM7QUFBQSxDQUFsQiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJleHBvcnQgY29uc3QgdG9BcnJheSA9IGFycmF5TGlrZSA9PiB7XG4gIGlmIChBcnJheS5pc0FycmF5KGFycmF5TGlrZSkpIHtcbiAgICByZXR1cm4gYXJyYXlMaWtlO1xuICB9XG5cbiAgaWYgKGFycmF5TGlrZSBpbnN0YW5jZW9mIE5vZGUpIHtcbiAgICByZXR1cm4gW2FycmF5TGlrZV07XG4gIH1cblxuICByZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJyYXlMaWtlKTtcbn07XG5cbmV4cG9ydCBjb25zdCAkID0gKHNlbGVjdG9yLCBjb250ZXh0ID0gZG9jdW1lbnQpID0+IChcbiAgdG9BcnJheShjb250ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwuY2FsbChjb250ZXh0LCBzZWxlY3RvcikpXG4pO1xuXG5leHBvcnQgY29uc3Qgc2VsZWN0b3IgPSAoYmxvY2ssIGVsZW0sIG1vZE5hbWUsIG1vZFZhbCkgPT4gKFxuICBgJHtibG9ja31fXyR7ZWxlbX0ke21vZE5hbWUgPyAobW9kVmFsID8gYF8ke21vZE5hbWV9XyR7bW9kVmFsfWAgOiBgXyR7bW9kTmFtZX1gKSA6ICcnfWBcbik7XG5cbmV4cG9ydCBjb25zdCBidWlsZENsYXNzID0gKC4uLmFyZ3MpID0+IGAuJHtzZWxlY3RvciguLi5hcmdzKX1gO1xuXG5leHBvcnQgY2xhc3MgQkVNIGV4dGVuZHMgbnVsbCB7XG4gIGNvbnN0cnVjdG9yKG5hbWUsIG5vZGUpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMubm9kZSA9IG5vZGU7XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgfVxuXG4gIGVsZW0obmFtZSwgbW9kTmFtZSwgbW9kVmFsKSB7XG4gICAgcmV0dXJuIHRoaXMubm9kZS5xdWVyeVNlbGVjdG9yKGJ1aWxkQ2xhc3ModGhpcy5uYW1lLCBuYW1lLCBtb2ROYW1lLCBtb2RWYWwpKTtcbiAgfVxuXG4gIGVsZW1zKG5hbWUsIG1vZE5hbWUsIG1vZFZhbCkge1xuICAgIHJldHVybiAkKGJ1aWxkQ2xhc3ModGhpcy5uYW1lLCBuYW1lLCBtb2ROYW1lLCBtb2RWYWwpLCB0aGlzLm5vZGUpO1xuICB9XG5cbiAgc2V0TW9kKGVsZW0sIGVsZW1OYW1lLCBtb2ROYW1lLCBtb2RWYWx1ZSkge1xuICAgIHRvQXJyYXkoZWxlbSkuZm9yRWFjaChub2RlID0+IChcbiAgICAgIG5vZGUuY2xhc3NMaXN0LmFkZChzZWxlY3Rvcih0aGlzLm5hbWUsIGVsZW1OYW1lLCBtb2ROYW1lLCBtb2RWYWx1ZSkpXG4gICAgKSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGRlbE1vZChlbGVtLCBlbGVtTmFtZSwgbW9kTmFtZSkge1xuICAgIHRvQXJyYXkoZWxlbSkuZm9yRWFjaChub2RlID0+IChcbiAgICAgIG5vZGUuY2xhc3NMaXN0LnJlbW92ZShzZWxlY3Rvcih0aGlzLm5hbWUsIGVsZW1OYW1lLCBtb2ROYW1lKSlcbiAgICApKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9XG59IiwiaW1wb3J0IHsgJCB9IGZyb20gJy4vZG9tJztcbmltcG9ydCB7IGZldGNoSlNPTiB9IGZyb20gJy4vdXRpbHMnO1xuXG5pbXBvcnQgU2VhcmNoIGZyb20gJy4vc2VhcmNoJztcblxuZmV0Y2hKU09OKCdkYXRhL3NlYXJjaC5qc29uJykudGhlbihkYXRhID0+IHtcbiAgJCgnLnNlYXJjaCcpLmZvckVhY2gobm9kZSA9PiBuZXcgU2VhcmNoKG5vZGUsIGRhdGEpKTtcbn0pOyIsImltcG9ydCB7IEJFTSwgc2VsZWN0b3IsIGJ1aWxkQ2xhc3MgfSBmcm9tICcuL2RvbSc7XG5cbmNvbnN0IEhPVkVSX0RFQk9VTkNFX1RJTUVPVVQgPSAyMDA7XG5cbmNvbnN0IGNyZWF0ZUl0ZW0gPSAoZGF0YSkgPT4ge1xuICBjb25zdCBub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcblxuICBub2RlLmNsYXNzTGlzdC5hZGQoc2VsZWN0b3IoJ3NlYXJjaCcsICdyZXN1bHQtaXRlbScpKTtcbiAgbm9kZS5pbm5lckhUTUwgPSBgXG4gICAgPGRpdiBjbGFzcz1cInNlYXJjaF9fcmVzdWx0LWl0ZW0tdGl0bGVcIj5cbiAgICAgICAgJHtkYXRhLm5hbWV9XG4gICAgPC9kaXY+XG4gICAgJHtkYXRhLmFkZHJlc3Muc2V0dGxlbWVudH0gPGJyIC8+XG4gICAgJHtkYXRhLmFkZHJlc3Muc3RyZWV0fSwgJHtkYXRhLmFkZHJlc3MuYnVpbGRpbmd9IDxiciAvPlxuICAgINCi0LXQuy46ICR7ZGF0YS5waG9uZXNbMF0ubnVtYmVyfSA8YnIgLz5cbiAgICDQk9C+0LTQuNC90Lgg0YDQvtCx0L7RgtC4OiDQn9C9LdCf0YIsIDk6MDAtMTk6MDBcbiAgYDtcblxuICByZXR1cm4gbm9kZTtcbn07XG5cbmNvbnN0IGdldFRvb2x0aXBDb250ZW50ID0gZGF0YSA9PiAoXG4gIGA8ZGl2IGNsYXNzPVwic2VhcmNoX19tYXAtdG9vbHRpcFwiPlxuICAgIDxiPiR7ZGF0YS5uYW1lfTwvYj4gPGJyIC8+XG4gICAgJHtkYXRhLmFkZHJlc3Muc2V0dGxlbWVudH0gPGJyIC8+XG4gICAgJHtkYXRhLmFkZHJlc3Muc3RyZWV0fSwgJHtkYXRhLmFkZHJlc3MuYnVpbGRpbmd9IDxiciAvPlxuICAgINCi0LXQuy46ICR7ZGF0YS5waG9uZXNbMF0ubnVtYmVyfSA8YnIgLz5cbiAgICBcbiAgICA8ZGl2IGNsYXNzPVwic2VhcmNoX19tYXAtdG9vbHRpcC1jb3VudFwiPlxuICAgICAgICAke2RhdGEuZG9jdG9yc31cbiAgICAgICAgPHNtYWxsPtC70ZbQutCw0YDRltCyPC9zbWFsbD5cbiAgICA8L2Rpdj5cbiAgICA8ZGl2IGNsYXNzPVwic2VhcmNoX19tYXAtdG9vbHRpcC1jb3VudFwiPlxuICAgICAgICAke2RhdGEuZGVjbGFyYXRpb25zfVxuICAgICAgICA8c21hbGw+0LTQtdC60LvQsNGA0LDRhtGW0Lkg0L/RltC00L/QuNGB0LDQvdC+PC9zbWFsbD5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+YFxuKTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VhcmNoIGV4dGVuZHMgQkVNIHtcbiAgbWFya2VycyA9IFtdO1xuICAkbWFya2VyTm9kZXMgPSBbXTtcblxuICB0aW1lb3V0ID0gbnVsbDtcblxuICBjb25zdHJ1Y3Rvcihub2RlLCBkYXRhKSB7XG4gICAgc3VwZXIoJ3NlYXJjaCcsIG5vZGUpO1xuXG4gICAgdGhpcy4kcmVzdWx0ID0gdGhpcy5lbGVtKCdyZXN1bHQnKTtcblxuICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gICAgdGhpcy5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKHRoaXMuZWxlbSgnbWFwJyksIHtcbiAgICAgIGNlbnRlcjogeyBsYXQ6IDUwLjQwMjEzNjgsIGxuZzogMzAuNDUyNTEwNyB9LFxuICAgICAgem9vbTogMTFcbiAgICB9KTtcblxuICAgIHRoaXMudG9vbHRpcCA9IG5ldyBnb29nbGUubWFwcy5JbmZvV2luZG93KHtcbiAgICAgIG1heFdpZHRoOiAyNTAsXG4gICAgICBwaXhlbE9mZnNldDogbmV3IGdvb2dsZS5tYXBzLlNpemUoMTM2LDM4OCksXG4gICAgICB6SW5kZXg6IC0yXG4gICAgfSk7XG5cbiAgICBjb25zdCBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcblxuICAgIHRoaXMuZGF0YS5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xuICAgICAgY29uc3Qgbm9kZSA9IGNyZWF0ZUl0ZW0oaXRlbSk7XG5cbiAgICAgIG5vZGUuZGF0YXNldC5pbmRleCA9IGluZGV4O1xuICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQobm9kZSk7XG5cbiAgICAgIGNvbnN0IG1hcmtlciA9IHRoaXMuY3JlYXRlTWFya2VyKGl0ZW0uYWRkcmVzcy5jb29yZGluYXRlcyk7XG4gICAgICB0aGlzLm1hcmtlcnMucHVzaChtYXJrZXIpO1xuICAgICAgdGhpcy4kbWFya2VyTm9kZXMucHVzaChub2RlKTtcblxuICAgICAgbWFya2VyLmFkZExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuc2V0QWN0aXZlKGluZGV4KSk7XG4gICAgICBtYXJrZXIuYWRkTGlzdGVuZXIoJ21vdXNlb3ZlcicsICh7IHRhIH0pID0+IHtcbiAgICAgICAgdGhpcy5vbkhvdmVyTWFya2VyKGluZGV4LCAnb3ZlcicsIHRhLnRhcmdldCk7XG4gICAgICB9KTtcbiAgICAgIG1hcmtlci5hZGRMaXN0ZW5lcignbW91c2VvdXQnLCAoKSA9PiB0aGlzLm9uSG92ZXJNYXJrZXIoaW5kZXgsICdvdXQnKSk7XG4gICAgfSk7XG5cbiAgICB0aGlzLiRyZXN1bHQuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xuXG4gICAgdGhpcy4kcmVzdWx0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKHsgdGFyZ2V0IH0pID0+IHtcbiAgICAgIGNvbnN0ICRpdGVtID0gdGFyZ2V0LmNsb3Nlc3QoYnVpbGRDbGFzcyh0aGlzLm5hbWUsICdyZXN1bHQtaXRlbScpKTtcblxuICAgICAgaWYgKCRpdGVtID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5tYXAuc2V0Q2VudGVyKHtcbiAgICAgICAgbGF0OiB0aGlzLmRhdGFbJGl0ZW0uZGF0YXNldC5pbmRleF0uYWRkcmVzcy5jb29yZGluYXRlc1swXSxcbiAgICAgICAgbG5nOiB0aGlzLmRhdGFbJGl0ZW0uZGF0YXNldC5pbmRleF0uYWRkcmVzcy5jb29yZGluYXRlc1sxXVxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMubWFwLnNldFpvb20oMTEpO1xuXG4gICAgICB0aGlzLnNldEFjdGl2ZSgkaXRlbS5kYXRhc2V0LmluZGV4KTtcbiAgICB9LCBmYWxzZSk7XG5cbiAgICB0aGlzLmFjdGl2ZU1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgbWFwOiB0aGlzLm1hcCxcbiAgICAgIHpJbmRleDogMixcbiAgICAgIGljb246IHtcbiAgICAgICAgdXJsOiAnaW1hZ2VzL2ljb25zL21hcmtlci5wbmcnLFxuICAgICAgICBzY2FsZWRTaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgzMywgNDcpLFxuICAgICAgICBhbmNob3I6IG5ldyBnb29nbGUubWFwcy5Qb2ludCgxNywgNjApLFxuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgb25Ib3Zlck1hcmtlcihpbmRleCwgdHlwZSkge1xuICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpO1xuICAgIHRoaXMudGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgIGNhc2UgJ292ZXInOlxuICAgICAgICAgIHRoaXMuc2hvd1Rvb2x0aXAoaW5kZXgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdvdXQnOlxuICAgICAgICAgIHRoaXMuaGlkZVRvb2x0aXAoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9LCBIT1ZFUl9ERUJPVU5DRV9USU1FT1VUKTtcbiAgfVxuXG4gIGhpZGVUb29sdGlwKCkge1xuICAgIGNvbnN0IG5vZGUgPSB0aGlzLiR0b29sdGlwTm9kZTtcblxuICAgIGlmICghbm9kZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHBsYXllciA9IG5vZGUuYW5pbWF0ZShbXG4gICAgICB7IG9wYWNpdHk6IDEsIHRyYW5zZm9ybTogJ3RyYW5zbGF0ZVkoMCknIH0sXG4gICAgICB7IG9wYWNpdHk6IDAsIHRyYW5zZm9ybTogJ3RyYW5zbGF0ZVkoLTIwcHgpJyB9XG4gICAgXSwgdGhpcy5jb25zdHJ1Y3Rvci5BTklNQVRJT05fT1BUSU9OUyk7XG5cbiAgICBjb25zdCBtYXJrZXIgPSB0aGlzLmhvdmVyTWFya2VyO1xuICAgIGxldCBzaXplID0gMjA7XG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uIGFuaW1hdGUoKSB7XG4gICAgICBpZiAoc2l6ZSA8PSAwKSB7XG4gICAgICAgIG1hcmtlci5zZXRNYXAobnVsbCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbWFya2VyLnNldEljb24oeyAuLi5tYXJrZXIuZ2V0SWNvbigpLCBzY2FsZTogc2l6ZX0pO1xuICAgICAgc2l6ZSA9IHNpemUgLSAyO1xuICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGUpO1xuICAgIH0pO1xuXG4gICAgcGxheWVyLm9uZmluaXNoID0gKCkgPT4ge1xuICAgICAgdGhpcy50b29sdGlwLmNsb3NlKCk7XG4gICAgfTtcblxuICAgIHRoaXMuYWN0aXZlSW5kZXggPSAtMTtcbiAgfVxuXG4gIHNob3dUb29sdGlwKGluZGV4KSB7XG4gICAgaWYgKGluZGV4ID09PSB0aGlzLmFjdGl2ZUluZGV4KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy50b29sdGlwLnNldENvbnRlbnQoZ2V0VG9vbHRpcENvbnRlbnQodGhpcy5kYXRhW2luZGV4XSkpO1xuICAgIHRoaXMudG9vbHRpcC5vcGVuKHRoaXMubWFwLCB0aGlzLm1hcmtlcnNbaW5kZXhdKTtcblxuICAgIGNvbnN0IG5vZGUgPSB0aGlzLiR0b29sdGlwTm9kZSA9IHRoaXMudG9vbHRpcE5vZGUucGFyZW50Tm9kZTtcbiAgICBub2RlLnJlbW92ZUNoaWxkKG5vZGUuZmlyc3RDaGlsZCk7XG4gICAgbm9kZS5yZW1vdmVDaGlsZChub2RlLmxhc3RDaGlsZCk7XG5cbiAgICBub2RlLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsICgpID0+IHtcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpO1xuICAgIH0sIGZhbHNlKTtcblxuICAgIG5vZGUuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdXQnLCAoKSA9PiB7XG4gICAgICB0aGlzLm9uSG92ZXJNYXJrZXIoaW5kZXgsICdvdXQnKTtcbiAgICB9LCBmYWxzZSk7XG5cbiAgICBpZiAodGhpcy5ob3Zlck1hcmtlcikge1xuICAgICAgdGhpcy5ob3Zlck1hcmtlci5zZXRNYXAobnVsbCk7XG4gICAgfVxuXG4gICAgY29uc3QgbWFya2VyID0gdGhpcy5ob3Zlck1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgcG9zaXRpb246IHtcbiAgICAgICAgbGF0OiB0aGlzLmRhdGFbaW5kZXhdLmFkZHJlc3MuY29vcmRpbmF0ZXNbMF0sXG4gICAgICAgIGxuZzogdGhpcy5kYXRhW2luZGV4XS5hZGRyZXNzLmNvb3JkaW5hdGVzWzFdXG4gICAgICB9LFxuICAgICAgekluZGV4OiAtMixcbiAgICAgIGljb246IHtcbiAgICAgICAgcGF0aDogZ29vZ2xlLm1hcHMuU3ltYm9sUGF0aC5DSVJDTEUsXG4gICAgICAgIHNjYWxlOiAwLFxuICAgICAgICBzdHJva2VDb2xvcjogJyM0ODgwZWQnLFxuICAgICAgICBmaWxsT3BhY2l0eTogMSxcbiAgICAgICAgZmlsbENvbG9yOiAnIzQ4ODBlZCdcbiAgICAgIH0sXG4gICAgICBvcGFjaXR5OiAuMSxcbiAgICAgIGRyYWdnYWJsZTogdHJ1ZSxcbiAgICAgIG1hcDogdGhpcy5tYXBcbiAgICB9KTtcblxuICAgIHRoaXMuYWN0aXZlSW5kZXggPSBpbmRleDtcblxuICAgIG1hcmtlci5hZGRMaXN0ZW5lcignbW91c2VvdmVyJywgKCkgPT4ge1xuICAgICAgdGhpcy5vbkhvdmVyTWFya2VyKGluZGV4LCAnb3ZlcicpO1xuICAgIH0pO1xuXG4gICAgbWFya2VyLmFkZExpc3RlbmVyKCdtb3VzZW91dCcsICgpID0+IHtcbiAgICAgIHRoaXMub25Ib3Zlck1hcmtlcihpbmRleCwgJ291dCcpO1xuICAgIH0pO1xuXG4gICAgbGV0IHNpemUgPSAwO1xuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbiBhbmltYXRlKCkge1xuICAgICAgaWYgKHNpemUgPj0gMjApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBtYXJrZXIuc2V0SWNvbih7IC4uLm1hcmtlci5nZXRJY29uKCksIHNjYWxlOiBzaXplfSk7XG4gICAgICBzaXplID0gc2l6ZSArIDI7XG4gICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoYW5pbWF0ZSk7XG4gICAgfSk7XG5cbiAgICBpZiAoaW5kZXggPT09IHRoaXMuYWN0aXZlTWFya2VySW5kZXgpIHtcbiAgICAgIHRoaXMudG9vbHRpcE5vZGUuYW5pbWF0ZShbXG4gICAgICAgIHsgb3BhY2l0eTogMCwgdHJhbnNmb3JtOiAndHJhbnNsYXRlWSgwcHgpJyB9LFxuICAgICAgICB7IG9wYWNpdHk6IDEsIHRyYW5zZm9ybTogJ3RyYW5zbGF0ZVkoMTBweCknIH1cbiAgICAgIF0sIHRoaXMuY29uc3RydWN0b3IuQU5JTUFUSU9OX09QVElPTlMpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnRvb2x0aXBOb2RlLmFuaW1hdGUoW1xuICAgICAgICB7IG9wYWNpdHk6IDAsIHRyYW5zZm9ybTogJ3RyYW5zbGF0ZVkoLTIwcHgpJyB9LFxuICAgICAgICB7IG9wYWNpdHk6IDEsIHRyYW5zZm9ybTogJ3RyYW5zbGF0ZVkoMCknIH1cbiAgICAgIF0sIHRoaXMuY29uc3RydWN0b3IuQU5JTUFUSU9OX09QVElPTlMpO1xuICAgIH1cbiAgfVxuXG4gIHNldEFjdGl2ZShpbmRleCkge1xuICAgIGlmIChpbmRleCA9PT0gdGhpcy5hY3RpdmVNYXJrZXJJbmRleCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHsgYWRkcmVzcyB9ID0gdGhpcy5kYXRhW2luZGV4XTtcbiAgICBjb25zdCAkaXRlbSA9IHRoaXMuJG1hcmtlck5vZGVzW2luZGV4XTtcblxuICAgIGlmIChpbmRleCA9PT0gdGhpcy5hY3RpdmVJbmRleCkge1xuICAgICAgdGhpcy50b29sdGlwTm9kZS5zdHlsZS50b3AgPSAnMThweCc7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuJGFjdGl2ZSkge1xuICAgICAgdGhpcy5kZWxNb2QodGhpcy4kYWN0aXZlLCAncmVzdWx0LWl0ZW0nLCAnYWN0aXZlJyk7XG4gICAgICB0aGlzLm1hcmtlcnNbdGhpcy4kYWN0aXZlLmRhdGFzZXQuaW5kZXhdLnNldEljb24odGhpcy5kZWZhdWx0TWFya2VySWNvbik7XG4gICAgfVxuXG4gICAgdGhpcy5zZXRNb2QoJGl0ZW0sICdyZXN1bHQtaXRlbScsICdhY3RpdmUnKTtcbiAgICB0aGlzLiRhY3RpdmUgPSAkaXRlbTtcbiAgICB0aGlzLmFjdGl2ZU1hcmtlckluZGV4ID0gTnVtYmVyKGluZGV4KTtcblxuICAgIHRoaXMubWFya2Vyc1skaXRlbS5kYXRhc2V0LmluZGV4XS5zZXRJY29uKHRoaXMuYWN0aXZlTWFya2VySWNvbik7XG5cbiAgICB0aGlzLmFjdGl2ZU1hcmtlci5zZXRQb3NpdGlvbih7IGxhdDogYWRkcmVzcy5jb29yZGluYXRlc1swXSwgbG5nOiBhZGRyZXNzLmNvb3JkaW5hdGVzWzFdIH0pXG4gIH1cblxuICBjcmVhdGVNYXJrZXIoW2xhdCwgbG5nXSkge1xuICAgIHJldHVybiBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcbiAgICAgIHBvc2l0aW9uOiB7bGF0LCBsbmd9LFxuICAgICAgekluZGV4OiAtMSxcbiAgICAgIGljb246IHRoaXMuZGVmYXVsdE1hcmtlckljb24sXG4gICAgICBkcmFnZ2FibGU6IGZhbHNlLFxuICAgICAgbWFwOiB0aGlzLm1hcFxuICAgIH0pO1xuICB9XG5cbiAgZ2V0IGRlZmF1bHRNYXJrZXJJY29uKCkge1xuICAgIHJldHVybiB7XG4gICAgICBwYXRoOiBnb29nbGUubWFwcy5TeW1ib2xQYXRoLkNJUkNMRSxcbiAgICAgIHNjYWxlOiA0LFxuICAgICAgc3Ryb2tlQ29sb3I6ICcjNDg4MGVkJyxcbiAgICAgIGZpbGxPcGFjaXR5OiAxLFxuICAgICAgZmlsbENvbG9yOiAnIzQ4ODBlZCdcbiAgICB9O1xuICB9XG5cbiAgZ2V0IGFjdGl2ZU1hcmtlckljb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHBhdGg6IGdvb2dsZS5tYXBzLlN5bWJvbFBhdGguQ0lSQ0xFLFxuICAgICAgc2NhbGU6IDgsXG4gICAgICBzdHJva2VDb2xvcjogJyM0ODgwZWQnLFxuICAgICAgZmlsbE9wYWNpdHk6IDEsXG4gICAgICBmaWxsQ29sb3I6ICcjZmZmZmZmJyxcbiAgICAgIHN0cm9rZVdlaWdodDogNlxuICAgIH07XG4gIH1cblxuICBnZXQgdG9vbHRpcE5vZGUoKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5nbS1zdHlsZS1pdycpO1xuICB9XG5cbiAgc3RhdGljIEFOSU1BVElPTl9PUFRJT05TID0ge1xuICAgIGR1cmF0aW9uOiAyMDAsXG4gICAgZmlsbDogJ2ZvcndhcmRzJyxcbiAgICBlYXNpbmc6ICdlYXNlLWluLW91dCdcbiAgfVxufSIsImNvbnN0IG9iamVjdFRvUXVlcnkgPSAodGFyZ2V0KSA9PiAoXG4gICc/JyArIE9iamVjdC5rZXlzKHRhcmdldCkucmVkdWNlKChhcnIsIGtleSkgPT4gKFxuICAgIGFyci5wdXNoKGAke2tleX09JHt0YXJnZXRba2V5XX1gKSAmJiBhcnJcbiAgKSwgW10pLmpvaW4oJyYnKVxuKTtcblxuZXhwb3J0IGNvbnN0IG51bWJlckZvcm1hdHRpbmcgPSBudW1iZXIgPT4gKFxuICBudW1iZXIudG9GaXhlZCgyKS5yZXBsYWNlKC8oXFxkKSg/PShcXGR7M30pK1xcLikvZywgJyQxICcpLnNwbGl0KCcuJylbMF1cbik7XG5cbmV4cG9ydCBjb25zdCBmZXRjaEpTT04gPSAodXJsLCBvcHRpb25zID0geyBtZXRob2Q6ICdHRVQnIH0pID0+IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgY29uc3QgcmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuXG4gIGlmIChvcHRpb25zLmJvZHkgJiYgb3B0aW9ucy5tZXRob2QgPT09ICdHRVQnKSB7XG4gICAgdXJsICs9IG9iamVjdFRvUXVlcnkob3B0aW9ucy5ib2R5KTtcbiAgfVxuXG4gIHJlcXVlc3Qub25yZWFkeXN0YXRlY2hhbmdlID0gKCkgPT4ge1xuICAgIGlmIChyZXF1ZXN0LnJlYWR5U3RhdGUgIT09IDQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICByZXNvbHZlKEpTT04ucGFyc2UocmVxdWVzdC5yZXNwb25zZVRleHQpKTtcbiAgfTtcblxuICByZXF1ZXN0Lm9uZXJyb3IgPSByZWplY3Q7XG4gIHJlcXVlc3Qub3BlbihvcHRpb25zLm1ldGhvZCB8fCAnR0VUJywgdXJsKTtcbiAgcmVxdWVzdC5zZW5kKG9wdGlvbnMuYm9keSA/IEpTT04uc3RyaW5naWZ5KG9wdGlvbnMuYm9keSkgOiBudWxsKTtcbn0pOyJdfQ==
